{
  "hash": "56e2e2b9a5a0c06e5f9a768463fc2489",
  "result": {
    "markdown": "<!-- # --- -->\n<!-- # title: \"blog data prep\" -->\n<!-- # author: \"Calum Nicholson\" -->\n<!-- # date: \"2023-09-05\" -->\n<!-- # output: html_document -->\n<!-- # --- -->\n\n<!-- # ```{r setup, include=FALSE} -->\n<!-- # knitr::opts_chunk$set(echo = TRUE) -->\n<!-- #  -->\n<!-- #  -->\n<!-- # library(tidyverse) -->\n<!-- # library(here) -->\n<!-- # library(ggconsort) -->\n<!-- # library(qwraps2) -->\n<!-- # ``` -->\n\n<!-- # Code for Blog Post -->\n\n<!-- Hi Mark, The code for each output is below, They wont run because I haven't included the data but a bit of background if you need it: -->\n\n<!--   - Consort Diagram: This is using a data flow that we to select patients for the registry, `el.sample` is a sample of the eligibility table, which contains a series of TRUE/FALSE flags that are used to determine the eligibility flags for each step (where \"el_final\" is the final eligibility and \"has_dx\" or \"has_proc\" flag whether diagnosis or procedure data are present). -->\n\n<!--   - Summary Table: This is a sample that from a recent poster of patients who had completed a DASS-21 survey. -->\n\n<!-- ### Build Consort Diagram (figure 1 for blog) -->\n\n<!-- ``` {r} -->\n<!-- study_cohorts <- el.sample %>% -->\n<!--                   cohort_start(\"Assessed for eligibility\") %>% -->\n<!--                   # Define cohorts using named expressions -->\n<!--                   cohort_define( -->\n<!--                     # Patient with missing diagnosis or procedure codes -->\n<!--                     missing = .full %>% filter(!has_dx & !has_proc),  -->\n<!--                     # only patients with diagnosis or procedure considered -->\n<!--                     considered = .full %>% filter(has_dx | has_proc), -->\n<!--                     # patients without congential heart disease -->\n<!--                     ineligibile = .full %>% filter(!el_final & (has_dx | has_proc)), -->\n<!--                     # patients with congential Heart Disease -->\n<!--                     eligibile = .full %>% filter(el_final)) %>% -->\n<!--                   # Provide text table for cohorts -->\n<!--                   cohort_label( -->\n<!--                     missing = \"No Diagnosis or Procedure\", -->\n<!--                     considered = \"Patients considered for eligibility\", -->\n<!--                     ineligibile = \"Ineligibile Patients\", -->\n<!--                     eligibile = \"Eligibile Patients\") -->\n\n<!-- study_consort <- study_cohorts %>%  -->\n<!--                   # Add the boxes -->\n<!--                   consort_box_add( -->\n<!--                     \"full\", 0, 50, cohort_count_adorn(study_cohorts, .full)) %>% -->\n<!--                   consort_box_add( -->\n<!--                     \"considered\", 0, 30, cohort_count_adorn(study_cohorts, considered)) %>% -->\n<!--                   consort_box_add( -->\n<!--                     \"eligibile\", 0, 10, cohort_count_adorn(study_cohorts, eligibile)) %>% -->\n<!--                   consort_box_add( -->\n<!--                     \"missing\", 5, 40, cohort_count_adorn(study_cohorts, missing)) %>% -->\n<!--                   consort_box_add( -->\n<!--                     \"ineligibile\", 5, 20, cohort_count_adorn(study_cohorts, ineligibile)) %>% -->\n<!--                   # Add the arrows -->\n<!--                   consort_arrow_add( -->\n<!--                     start = \"full\", start_side = \"bottom\", -->\n<!--                     end = \"considered\", end_side = \"top\") %>% -->\n<!--                   consort_arrow_add( -->\n<!--                     start = \"considered\", start_side = \"bottom\", -->\n<!--                     end = \"eligibile\", end_side = \"top\") %>% -->\n<!--                   consort_arrow_add( -->\n<!--                     end = \"missing\", end_side = \"left\", start_x = 0, start_y = 40) %>% -->\n<!--                   consort_arrow_add( -->\n<!--                     end = \"ineligibile\", end_side = \"left\", start_x = 0, start_y = 20) %>%  -->\n<!--               # Plot with ggplot -->\n<!--               ggplot() + -->\n<!--               geom_consort() + -->\n<!--               theme_consort(margin_h = 15, margin_v = 1) -->\n\n<!-- study_consort -->\n<!-- ``` -->\n\n<!-- ``` {r} -->\n<!-- #ggsave(\"consort_flow.jpg\", study_consort) -->\n<!-- ``` -->\n\n<!-- ### Summary Table (Figure 2 for Blog) -->\n\n<!-- This code wont run, its from a separate project and the data are not loaded in for it, just here for an example of the summary table -->\n\n<!-- ``` {r} -->\n<!-- options(qwraps_markup = \"markdown\") -->\n\n<!-- # Create Table Template for DASS-21 Summary -->\n<!-- dass_level_summary <- -->\n<!--   list(\"Depression\" = -->\n<!--          list(\"Normal\" = ~ n_perc0(dass_dep_level_clean == \"Normal\"), -->\n<!--               \"Mild\" = ~ n_perc0(dass_dep_level_clean == \"Mild\"), -->\n<!--               \"Moderate\" = ~ n_perc0(dass_dep_level_clean == \"Moderate\"), -->\n<!--               \"Severe\" = ~ n_perc0(dass_dep_level_clean == \"Severe\"), -->\n<!--               \"Extemely Severe\" = ~ n_perc0(dass_dep_level_clean == \"Extemely Severe\"), -->\n<!--               ), -->\n<!--        \"Anxiety\" = -->\n<!--          list(\"Normal\" = ~ n_perc0(dass_anx_level_clean == \"Normal\"), -->\n<!--               \"Mild\" = ~ n_perc0(dass_anx_level_clean == \"Mild\"), -->\n<!--               \"Moderate\" = ~ n_perc0(dass_anx_level_clean == \"Moderate\"), -->\n<!--               \"Severe\" = ~ n_perc0(dass_anx_level_clean == \"Severe\"), -->\n<!--               \"Extemely Severe\" = ~ n_perc0(dass_anx_level_clean == \"Extemely Severe\"), -->\n<!--               ), -->\n<!--        \"Stress\" =  -->\n<!--          list(\"Normal\" = ~ n_perc0(dass_stress_level_clean == \"Normal\"), -->\n<!--               \"Mild\" = ~ n_perc0(dass_stress_level_clean == \"Mild\"), -->\n<!--               \"Moderate\" = ~ n_perc0(dass_stress_level_clean == \"Moderate\"), -->\n<!--               \"Severe\" = ~ n_perc0(dass_stress_level_clean == \"Severe\"), -->\n<!--               \"Extemely Severe\" = ~ n_perc0(dass_stress_level_clean == \"Extemely Severe\"), -->\n<!--               ) -->\n<!--        ) -->\n\n<!-- # Summary Table for whole dataset -->\n<!-- dass.level.whole <- summary_table(poster.population, dass_level_summary) -->\n<!-- # Summary table stratified by complexity -->\n<!-- dass.level.complexity <- summary)table(dyplr::group_by(poster.population, chd_complexity), dass_level_summary) -->\n\n<!-- # Combine both tables -->\n<!-- dass.level <- cbind(dass.level.whole, dass.level.complexity) -->\n\n<!-- # Print table with title -->\n<!-- print(dass.level, -->\n<!--       rtitle = \"DASS-21 Level - Summary Statistics\", -->\n<!--       cnames( c(paste(\"All (N -\", poster.population %>% nrow, \")\", sep = \"\"), -->\n<!--                 paste(\"Mild (N -\", poster.population %>% filter(chd_complexity = \"Mild\") %>% nrow, \")\", sep = \"\"), -->\n<!--                 paste(\"Moderate (N -\", poster.population %>% filter(chd_complexity = \"Moderate\") %>% nrow, \")\", sep = \"\"), -->\n<!--                 paste(\"Severe (N -\", poster.population %>% filter(chd_complexity = \"Severe\") %>% nrow, \")\", sep = \"\") -->\n<!--                 ) -->\n<!--               ) -->\n<!-- ) -->\n\n<!-- ``` -->\n\n\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}